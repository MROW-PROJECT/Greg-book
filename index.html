<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Greg Book - Cruise Booking</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    .card-hover { transition: all 0.3s ease; }
    .card-hover:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;

    const Ship = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M2 21c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1 .6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1"/>
        <path d="M19.38 20A11.6 11.6 0 0 0 21 14l-9-4-9 4c0 2.9.94 5.34 2.81 7.76"/>
        <path d="M19 13V7a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v6"/>
      </svg>
    );

    const CheckCircle = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
        <polyline points="22 4 12 14.01 9 11.01"/>
      </svg>
    );

    const RefreshCw = ({ size = 24 }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
        <polyline points="23 4 23 10 17 10"/>
        <polyline points="1 20 1 14 7 14"/>
        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/>
      </svg>
    );

    const GregBookApp = () => {
      const [step, setStep] = useState(1);
      const [form, setForm] = useState({
        region: '',
        cruise: null,
        guests: 2,
        roomType: '',
        robloxUser: '',
        discordUser: ''
      });
      const [cruises, setCruises] = useState([]);
      const [loading, setLoading] = useState(false);
      const [bookingId, setBookingId] = useState(null);

      // Region schedule URLs - REPLACE WITH YOUR ACTUAL URLs
      const scheduleUrls = {
        'Bahamas': 'https://sites.google.com/view/visit-cr-cruiseline-com/plan-your-cruise/bahamas-page?authuser=0',
        'Mexico': 'https://sites.google.com/view/visit-cr-cruiseline-com/plan-your-cruise/mexico-page?authuser=0', 
        'Hawaii': 'https://sites.google.com/view/visit-cr-cruiseline-com/plan-your-cruise/hawaii-page?authuser=0',
        'New York': 'https://sites.google.com/view/visit-cr-cruiseline-com/plan-your-cruise/new-york-page?authuser=0'
      };

      const roomTypes = [
        { type: 'Interior', multiplier: 1 },
        { type: 'Ocean View', multiplier: 1.2 },
        { type: 'Balcony', multiplier: 1.5 },
        { type: 'Suite', multiplier: 2 }
      ];

      const fetchSchedules = async (region) => {
        setLoading(true);
        try {
          // In production, this would fetch from the actual website
          // For now, returning mock data structure
          const mockData = [
            { ship: 'CR Galaxy', nights: 4, price: 199, date: 'Feb 15, 2026', itinerary: "Ocean's Edge & Nassau" },
            { ship: 'CR Dream', nights: 4, price: 1499, date: 'Mar 01, 2026', itinerary: "Ocean's Edge & Nassau" },
            { ship: 'CR Caribbean', nights: 7, price: 1100, date: 'Apr 05, 2026', itinerary: "Bahamas Round Trip" }
          ];
          setCruises(mockData);
        } catch (err) {
          console.error('Failed to fetch schedules');
        }
        setLoading(false);
      };

      const handleRegionSelect = (region) => {
        setForm({ ...form, region, cruise: null });
        fetchSchedules(region);
      };

      const calculateTotal = () => {
        if (!form.cruise || !form.roomType) return 0;
        const room = roomTypes.find(r => r.type === form.roomType);
        return form.cruise.price * room.multiplier * form.guests;
      };

      const submitBooking = () => {
        const id = `GB-${Date.now()}`;
        setBookingId(id);
        
        // Send to Discord webhook
        const webhook = 'https://discord.com/api/webhooks/1462305721080221847/65dPZEh2o2vUyew4XT6EV1eQSgufkHqowH166Z_W8Y6tR1tUwE7sOfh4NxJJMEEXHgtM';
        fetch(webhook, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            embeds: [{
              title: 'ðŸš¢ New Booking',
              color: 3066993,
              fields: [
                { name: 'ID', value: id },
                { name: 'Roblox', value: form.robloxUser },
                { name: 'Discord', value: form.discordUser },
                { name: 'Cruise', value: form.cruise.ship },
                { name: 'Date', value: form.cruise.date },
                { name: 'Guests', value: form.guests.toString() },
                { name: 'Room', value: form.roomType },
                { name: 'Total', value: `$${calculateTotal().toFixed(2)}` }
              ]
            }]
          })
        }).catch(() => {});
        
        setStep(4);
      };

      return (
        <div className="min-h-screen p-4">
          <div className="max-w-4xl mx-auto">
            {/* Header */}
            <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
              <div className="flex items-center gap-3">
                <Ship size={36} className="text-blue-600" />
                <div>
                  <h1 className="text-2xl font-bold">Greg Book</h1>
                  <p className="text-sm text-gray-600">Independent Cruise Booking</p>
                </div>
              </div>
            </div>

            {/* Step 1: Region Selection */}
            {step === 1 && (
              <div className="bg-white rounded-xl shadow-lg p-6">
                <h2 className="text-xl font-bold mb-4">Select Region</h2>
                <div className="grid grid-cols-2 gap-4">
                  {Object.keys(scheduleUrls).map(region => (
                    <button
                      key={region}
                      onClick={() => { handleRegionSelect(region); setStep(2); }}
                      className="p-6 border-2 rounded-lg hover:border-blue-500 transition card-hover"
                    >
                      <h3 className="text-lg font-bold">{region}</h3>
                    </button>
                  ))}
                </div>
              </div>
            )}

            {/* Step 2: Cruise Selection */}
            {step === 2 && (
              <div className="bg-white rounded-xl shadow-lg p-6">
                <div className="flex justify-between items-center mb-4">
                  <h2 className="text-xl font-bold">Available Cruises - {form.region}</h2>
                  <button onClick={() => fetchSchedules(form.region)} className="flex items-center gap-2 text-blue-600">
                    <RefreshCw size={20} />
                    Refresh
                  </button>
                </div>
                
                {loading ? (
                  <p className="text-center py-8">Loading schedules...</p>
                ) : (
                  <div className="space-y-4">
                    {cruises.map((cruise, idx) => (
                      <button
                        key={idx}
                        onClick={() => { setForm({ ...form, cruise }); setStep(3); }}
                        className="w-full p-4 border-2 rounded-lg hover:border-blue-500 transition text-left"
                      >
                        <div className="flex justify-between">
                          <div>
                            <h3 className="font-bold">{cruise.ship}</h3>
                            <p className="text-sm text-gray-600">{cruise.itinerary}</p>
                            <p className="text-sm">{cruise.nights} nights â€¢ {cruise.date}</p>
                          </div>
                          <div className="text-right">
                            <p className="text-2xl font-bold text-blue-600">${cruise.price}</p>
                          </div>
                        </div>
                      </button>
                    ))}
                  </div>
                )}
                
                <button onClick={() => setStep(1)} className="mt-4 px-4 py-2 bg-gray-100 rounded">
                  Back
                </button>
              </div>
            )}

            {/* Step 3: Guest Details */}
            {step === 3 && (
              <div className="bg-white rounded-xl shadow-lg p-6 space-y-4">
                <h2 className="text-xl font-bold">Booking Details</h2>
                
                <div>
                  <label className="block mb-2 font-medium">Guests</label>
                  <div className="flex gap-2">
                    {[1,2,3,4].map(n => (
                      <button
                        key={n}
                        onClick={() => setForm({ ...form, guests: n })}
                        className={`px-4 py-2 rounded ${form.guests === n ? 'bg-blue-600 text-white' : 'bg-gray-100'}`}
                      >
                        {n}
                      </button>
                    ))}
                  </div>
                </div>

                <div>
                  <label className="block mb-2 font-medium">Room Type</label>
                  <div className="grid grid-cols-2 gap-3">
                    {roomTypes.map(room => (
                      <button
                        key={room.type}
                        onClick={() => setForm({ ...form, roomType: room.type })}
                        className={`p-4 border-2 rounded ${form.roomType === room.type ? 'border-blue-600 bg-blue-50' : 'border-gray-200'}`}
                      >
                        <div className="font-bold">{room.type}</div>
                        <div className="text-sm text-gray-600">
                          ${(form.cruise.price * room.multiplier * form.guests).toFixed(2)}
                        </div>
                      </button>
                    ))}
                  </div>
                </div>

                <div>
                  <label className="block mb-2 font-medium">Roblox Username</label>
                  <input
                    type="text"
                    className="w-full p-3 border rounded"
                    value={form.robloxUser}
                    onChange={e => setForm({ ...form, robloxUser: e.target.value })}
                  />
                </div>

                <div>
                  <label className="block mb-2 font-medium">Discord Username</label>
                  <input
                    type="text"
                    className="w-full p-3 border rounded"
                    value={form.discordUser}
                    onChange={e => setForm({ ...form, discordUser: e.target.value })}
                  />
                </div>

                <div className="flex gap-3 pt-4">
                  <button onClick={() => setStep(2)} className="px-4 py-2 bg-gray-100 rounded">
                    Back
                  </button>
                  <button
                    onClick={submitBooking}
                    disabled={!form.roomType || !form.robloxUser || !form.discordUser}
                    className="flex-1 px-4 py-2 bg-blue-600 text-white rounded disabled:opacity-50"
                  >
                    Confirm Booking - ${calculateTotal().toFixed(2)}
                  </button>
                </div>
              </div>
            )}

            {/* Step 4: Confirmation */}
            {step === 4 && (
              <div className="bg-white rounded-xl shadow-lg p-6 text-center space-y-4">
                <CheckCircle size={64} className="text-green-600 mx-auto" />
                <h2 className="text-2xl font-bold">Booking Confirmed!</h2>
                <p className="text-lg">Booking ID: <span className="font-mono">{bookingId}</span></p>
                <div className="bg-gray-50 p-4 rounded text-left">
                  <p><strong>Ship:</strong> {form.cruise.ship}</p>
                  <p><strong>Date:</strong> {form.cruise.date}</p>
                  <p><strong>Guests:</strong> {form.guests}</p>
                  <p><strong>Room:</strong> {form.roomType}</p>
                  <p className="text-xl font-bold pt-2">Total: ${calculateTotal().toFixed(2)}</p>
                </div>
                <button
                  onClick={() => { setStep(1); setForm({ region: '', cruise: null, guests: 2, roomType: '', robloxUser: '', discordUser: '' }); }}
                  className="px-6 py-2 bg-blue-600 text-white rounded"
                >
                  New Booking
                </button>
              </div>
            )}
          </div>
        </div>
      );
    };

    ReactDOM.render(<GregBookApp />, document.getElementById('root'));
  </script>
</body>
</html>
